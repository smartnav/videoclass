const socket = io('http://localhost:4000/');
// const socket = io('https://socket.kidatcode.com');

// Alert With Input Type
$("body").on("click", "#redirectLink", function (e) {
    let current = $(this);
    swal({
        title: "Enter your name",
        input: "text",
        inputPlaceholder: "Jhon Doe",
        showCancelButton: true,
        confirmButtonText: "Submit",
        allowOutsideClick: true,
    }).then((result) => {
        if (result.value) {
            location.href =
                "https://smartnav.github.io/videoclass/videoModule/student.html?role=" +
                current.data("type") +
                "&name=" +
                result.value;
        }
    });
});

$("body").on("click", ".header #people", function () {
    $(".chatBox").addClass("showPeopleList");
    $(".chatBox").removeClass("showMsgBox");
});

$("body").on("click", ".header #chat", function () {
    $(".chatBox").removeClass("showPeopleList");
    $(".chatBox").addClass("showMsgBox");
});

// new change start

$("body").on("click", ".chatBox .close", function () {
    $(".chatBox").removeClass("show");
});

$("body").on("click", "#toggleChatBox", function () {
    $(".chatBox").addClass("show");
    $(".header #chat").trigger("click");
});

$("body").on("click", "#togglePeopleBox", function () {
    $(".chatBox").addClass("show");
    $(".header #people").trigger("click");
});
// new change end

$("body").on("click", ".chatBox .msgBox .footer button", function () {
    let msg = $(".chatBox .msgBox input").val();
    let imgSrc = "img/boy.png";
    let userName = "Jhon doe1 d";
    $(".chatBox .msgBox input").val("");
    $(".chatBox .msgBox input").focus();
    printMsg(userName, imgSrc, msg);
});

function printMsg(name, img, msg) {
    let html = "";
    html +=
        '<!-- msg start --><div class="sent"><div class="nameMsg"><div class="name">' +
        name +
        '</div><div class="msg">' +
        msg +
        '</div></div><div class="userIcon"><img src="' +
        img +
        '" alt="receiver image"></div></div><!-- msg end -->';
    if (msg.length) {
        $(".chatBox .msgBox .messages").append(html);
        $(".chatBox .msgBox .messages").animate(
            { scrollTop: $($(".chatBox .msgBox .messages")).height() },
            250
        );

        let countBox = $(".video .videoMenu .notification .count");
        let count = parseInt(countBox.text());
        countBox.text(count + 1);
    }
}

$("body").on("click", ".chatBox .msgBox .footer .toggleEmoji", function () {
    $(".chatBox .msgBox .footer .emojisBox").slideToggle();
});

$("body").on("click", ".chatBox .msgBox .footer .emojisBox img", function () {
    let imgSrc = "img/boy.png";
    let userName = "Jhon doe";
    let emoji = $(this).attr("src");
    $(".chatBox .msgBox .footer .emojisBox").slideToggle();
    sendEmoji(userName, imgSrc, emoji);
});

function sendEmoji(name, img, emoji) {
    let html = "";
    html +=
        '<!-- msg start --><div class="sent"><div class="nameMsg"><div class="name">' +
        name +
        '</div><div class="msg"><img src="' +
        emoji +
        '" alt="Emoji"/></div></div><div class="userIcon"><img src="' +
        img +
        '" alt="receiver image"></div></div><!-- msg end -->';
    if (emoji.length) {
        $(".chatBox .msgBox .messages").append(html);
        $(".chatBox .msgBox .messages").animate(
            { scrollTop: $($(".chatBox .msgBox .messages")).height() },
            250
        );
        let countBox = $(".video .videoMenu .notification .count");
        let count = parseInt(countBox.text());
        countBox.text(count + 1);
    }
}
